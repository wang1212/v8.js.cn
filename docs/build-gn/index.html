<!doctype html><html lang=zh-CN><meta charset=utf-8><title>Building V8 with GN · V8</title><meta content="width=device-width,initial-scale=1" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=' js'</script><meta content="This document explains how to use GN to build V8." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li><a href=/blog/ >博客</a><li class=active><a href=/docs/ >文档</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><h1>Building V8 with GN</h1><p>V8 is built with the help of <a href=https://gn.googlesource.com/gn/+/master/docs/ >GN</a>. GN is a meta build system of sorts, as it generates build files for a number of other build systems. How you build therefore depends on what “back-end” build system and compiler you’re using.<br>The instructions below assume that you already have a <a href=/docs/source-code>checkout of V8</a> and that you have <a href=/docs/build>installed the build dependencies</a>.<p>More information on GN can be found in <a href=https://www.chromium.org/developers/gn-build-configuration>Chromium’s documentation</a> or <a href=https://gn.googlesource.com/gn/+/master/docs/ >GN’s own docs</a>.<p>Building V8 from source involves three steps:<ol><li>generating build files<li>compiling<li>running tests</ol><p>There are two workflows for building V8:<ul><li>the convenience workflow using a helper script called <code>gm</code> that nicely combines all three steps<li>the raw workflow, where you run separate commands on a lower level for each step manually</ul><h2 id=gm>Building V8 using <code>gm</code> (the convenience workflow) <a href=#gm class=bookmark>#</a></h2><p><code>gm</code> is a convenience all-in-one script that generates build files, triggers the build and optionally also runs the tests. It can be found at <code>tools/dev/gm.py</code> in your V8 checkout. We recommend adding an alias to your shell configuration:<pre class=language-bash><code class=language-bash><span class="token builtin class-name">alias</span> <span class="token assign-left variable">gm</span><span class="token operator">=</span>/path/to/v8/tools/dev/gm.py</code></pre><p>You can then use <code>gm</code> to build V8 for known configurations, such as <code>x64.release</code>:<pre class=language-bash><code class=language-bash>gm x64.release</code></pre><p>To run the tests right after the build, run:<pre class=language-bash><code class=language-bash>gm x64.release.check</code></pre><p><code>gm</code> outputs all the commands it’s executing, making it easy to track and re-execute them if necessary.<p><code>gm</code> enables building the required binaries and running specific tests with a single command:<pre class=language-bash><code class=language-bash>gm x64.debug mjsunit/foo cctest/test-bar/*</code></pre><h2 id=manual>Building V8: the raw, manual workflow <a href=#manual class=bookmark>#</a></h2><h3 id=generate-build-files>Step 1: generate build files <a href=#generate-build-files class=bookmark>#</a></h3><p>There are several ways of generating the build files:<ol><li>The raw, manual workflow involves using <code>gn</code> directly.<li>A helper script named <code>v8gen</code> streamlines the process for common configurations.</ol><h4 id=gn>Generating build files using <code>gn</code> <a href=#gn class=bookmark>#</a></h4><p>Generate build files for the directory <code>out/foo</code> using <code>gn</code>:<pre class=language-bash><code class=language-bash>gn args out/foo</code></pre><p>This opens an editor window for specifying the <a href=https://gn.googlesource.com/gn/+/master/docs/reference.md><code>gn</code> arguments</a>. Alternatively, you can pass the arguments on the command line:<pre class=language-bash><code class=language-bash>gn gen out/foo --args<span class="token operator">=</span><span class="token string">'is_debug=false target_cpu="x64" v8_target_cpu="arm64" use_goma=true'</span></code></pre><p>This generates build files for compiling V8 with the arm64 simulator in release mode using <code>goma</code> for compilation.<p>For an overview of all available <code>gn</code> arguments, run:<pre class=language-bash><code class=language-bash>gn args out/foo --list</code></pre><h4 id=v8gen>Generate build files using <code>v8gen</code> <a href=#v8gen class=bookmark>#</a></h4><p>The V8 repository includes a <code>v8gen</code> convenience script to more easily generate build files for common configurations. We recommend adding an alias to your shell configuration:<pre class=language-bash><code class=language-bash><span class="token builtin class-name">alias</span> <span class="token assign-left variable">v8gen</span><span class="token operator">=</span>/path/to/v8/tools/dev/v8gen.py</code></pre><p>Call <code>v8gen --help</code> for more information.<p>List available configurations (or bots from a master):<pre class=language-bash><code class=language-bash>v8gen list</code></pre><pre class=language-bash><code class=language-bash>v8gen list -m client.v8</code></pre><p>Build like a particular bot from the <code>client.v8</code> waterfall in folder <code>foo</code>:<pre class=language-bash><code class=language-bash>v8gen -b <span class="token string">'V8 Linux64 - debug builder'</span> -m client.v8 foo</code></pre><h3 id=compile>Step 2: compile V8 <a href=#compile class=bookmark>#</a></h3><p>To build all of V8 (assuming <code>gn</code> generated to the <code>x64.release</code> folder), run:<pre class=language-bash><code class=language-bash>ninja -C out/x64.release</code></pre><p>To build specific targets like <code>d8</code>, append them to the command:<pre class=language-bash><code class=language-bash>ninja -C out/x64.release d8</code></pre><h3 id=tests>Step 3: run tests <a href=#tests class=bookmark>#</a></h3><p>You can pass the output directory to the test driver. Other relevant flags are inferred from the build:<pre class=language-bash><code class=language-bash>tools/run-tests.py --outdir out/foo</code></pre><p>You can also test your most recently compiled build (in <code>out.gn</code>):<pre class=language-bash><code class=language-bash>tools/run-tests.py --gn</code></pre><p><strong>Build issues? File a bug at <a href=/bug>v8.dev/bug</a> or ask for help on <a href=mailto:v8-users@googlegroups.com>v8-users@googlegroups.com</a>.</strong></main><footer id=footer><div><nav><a href=https://v8.dev/docs/build-gn>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/docs/build-gn.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>