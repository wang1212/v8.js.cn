<!doctype html><html lang=zh-CN><meta charset=utf-8><title>Evaluating code coverage · V8</title><meta content="width=device-width,initial-scale=1" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=' js'</script><meta content="This document explains what to do if you’re working on a change in V8 and you want to evaluate its code coverage." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li><a href=/blog/ >博客</a><li class=active><a href=/docs/ >文档</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><h1>Evaluating code coverage</h1><p>You are working on a change. You want to evaluate code coverage for your new code.<p>V8 provides two tools for doing this: local, on your machine; and build infrastructure support.<h2 id=local>Local <a href=#local class=bookmark>#</a></h2><p>Relative to the root of the v8 repo, use <code>./tools/gcov.sh</code> (tested on linux). This uses gnu’s code coverage tooling and some scripting to produce an HTML report, where you can drill down coverage info per directory, file, and then down to line of code.<p>The script builds V8 under a separate <code>out</code> directory, using <code>gcov</code> settings. We use a separate directory to avoid clobbering your normal build settings. This separate directory is called <code>cov</code> — it is created immediately under the repo root. <code>gcov.sh</code> then runs the test suite, and produces the report. The path to the report is provided when the script completes.<p>If your change has architecture specific components, you can cumulatively collect coverage from architecture specific runs.<pre class=language-bash><code class=language-bash>./tools/gcov.sh x64 arm</code></pre><p>This rebuilds in-place for each architecture, clobbering the binaries from the previous run, but preserving and accumulating over the coverage results.<p>By default, the script collects from <code>Release</code> runs. If you want <code>Debug</code>, you may specify so:<pre class=language-bash><code class=language-bash><span class="token assign-left variable">BUILD_TYPE</span><span class="token operator">=</span>Debug ./tools/gcov.sh x64 arm arm64</code></pre><p>Running the script with no options will provide a summary of options as well.<h2 id=code-coverage-bot>Code coverage bot <a href=#code-coverage-bot class=bookmark>#</a></h2><p>For each change that landed, we run a x64 coverage analysis — see the <a href=https://ci.chromium.org/p/v8/builders/luci.v8.ci/V8%20Linux64%20-%20gcov%20coverage>coverage bot</a>. We don't run bots for coverage for other architectures.<p>To get the report for a particular run, you want to list the build steps, find the “gsutil coverage report” one (towards the end), and open the “report” under it.</main><footer id=footer><div><nav><a href=https://v8.dev/docs/evaluate-code-coverage>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/docs/evaluate-code-coverage.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>