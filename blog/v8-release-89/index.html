<!doctype html><html lang=zh-CN><meta charset=utf-8><title>V8 release v8.9 · V8</title><meta content="width=device-width,initial-scale=1" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=' js'</script><meta content="V8 release v8.9 brings performance improvements to calls with argument size mismatch." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li class=active><a href=/blog/ >博客</a><li><a href=/docs/ >文档</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>V8 release v8.9</h1><p class=meta>发布时间 <time datetime="2021-02-04 00:00:00" itemprop=datePublished title="2021-02-04 00:00:00">2021-02-04</time> · 标签： <a href=/blog/tags/release/ class=tag>release</a></header><div itemprop=articleBody><p>Every six weeks, we create a new branch of V8 as part of our <a href=https://v8.dev/docs/release-process>release process</a>. Each version is branched from V8’s Git master immediately before a Chrome Beta milestone. Today we’re pleased to announce our newest branch, <a href=https://chromium.googlesource.com/v8/v8.git/+log/branch-heads/8.9>V8 version 8.9</a>, which is in beta until its release in coordination with Chrome 89 Stable in several weeks. V8 v8.9 is filled with all sorts of developer-facing goodies. This post provides a preview of some of the highlights in anticipation of the release.<h2 id=javascript>JavaScript <a href=#javascript class=bookmark>#</a></h2><h3 id=top-level-await>Top-level <code>await</code> <a href=#top-level-await class=bookmark>#</a></h3><p><a href=https://v8.dev/features/top-level-await>Top-level <code>await</code></a> is available in the <a href=https://www.chromium.org/blink>Blink rendering engine</a> 89, a primary embedder of V8.<p>In standalone V8, top-level <code>await</code> remains behind the <code>--harmony-top-level-await</code> flag.<p>Please see <a href=https://v8.dev/features/top-level-await>our explainer</a> for more details.<h2 id=performance>Performance <a href=#performance class=bookmark>#</a></h2><h3 id=faster-calls-with-arguments-size-mismatch>Faster calls with arguments size mismatch <a href=#faster-calls-with-arguments-size-mismatch class=bookmark>#</a></h3><p>JavaScript allows calling a function with a different number of arguments than the expected number of parameters, i.e., one can pass either fewer or more arguments than the declared formal parameters. The former case is called under-application and the latter is called over-application.<p>In the under-application case, the remaining parameters get assigned to the <code>undefined</code> value. In the over-application case, the remaining arguments can be either accessed by using the rest parameter and the <code>Function.prototype.arguments</code> property, or they are simply superfluous and ignored. Many web and Node.js frameworks nowadays use this JS feature to accept optional parameters and create a more flexible API.<p>Until recently, V8 had a special machinery to deal with arguments size mismatch: the arguments adaptor frame. Unfortunately, argument adaption comes at a performance cost and is commonly needed in modern front-end and middleware frameworks. It turns out that with a clever design (like reversing the order of the arguments in the stack), we can remove this extra frame, simplify the V8 codebase, and get rid of the overhead almost entirely.<figure><img alt="" height=371 loading=lazy src=/_img/v8-release-89/perf.svg width=600><figcaption>Performance impact of removing the arguments adaptor frame, as measured through a micro-benchmark.</figcaption></figure><p>The graph shows that there is no overhead anymore when running on <a href=https://v8.dev/blog/jitless>JIT-less mode</a> (Ignition) with a 11.2% performance improvement. When using TurboFan, we get up to 40% speedup. The overhead compared to the no mismatch case is due to a small optimization in the <a href="https://source.chromium.org/chromium/chromium/src/+/master:v8/src/compiler/backend/x64/code-generator-x64.cc;l=4905;drc=5056f555010448570f7722708aafa4e55e1ad052">function epilogue</a>. For more details, see <a href=https://docs.google.com/document/d/15SQV4xOhD3K0omGJKM-Nn8QEaskH7Ir1VYJb9_5SjuM/edit>the design document</a>.<p>If you want to learn more about the details behind those improvements, check out the <a href=https://v8.dev/blog/adaptor-frame>dedicated blog post</a>.<h2 id=v8-api>V8 API <a href=#v8-api class=bookmark>#</a></h2><p>Please use <code>git log branch-heads/8.8..branch-heads/8.9 include/v8.h</code> to get a list of the API changes.<p>Developers with an active V8 checkout can use <code>git checkout -b 8.9 -t branch-heads/8.9</code> to experiment with the new features in V8 v8.9. Alternatively you can <a href=https://www.google.com/chrome/browser/beta.html>subscribe to Chrome’s Beta channel</a> and try the new features out yourself soon.</div><footer><div><picture><source srcset="/_img/avatars/ingvar-stepanyan.avif, /_img/avatars/ingvar-stepanyan@2x.avif 2x" type=image/avif><img alt="" height=96 loading=lazy src=/_img/avatars/ingvar-stepanyan.jpg width=96 srcset="/_img/avatars/ingvar-stepanyan@2x.jpg 2x"></picture><p>作者：Ingvar Stepanyan, awaiting a call.</div><a href=https://twitter.com/v8js/status/1357358418902802434 class=retweet>Retweet this article!</a></footer></article></main><footer id=footer><div><nav><a href=https://v8.dev/blog/v8-release-89>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/blog/v8-release-89.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>