<!doctype html><html lang=zh-CN><meta charset=utf-8><title>Announcing the Web Tooling Benchmark · V8</title><meta content="width=device-width,initial-scale=1" name=viewport><meta content="dark light" name=color-scheme><link href=/_css/main.css rel=stylesheet><link href=/.webmanifest rel=manifest><meta content=#4285F4 name=theme-color><link href=/blog.atom rel=alternate title="V8 Atom feed" type=application/atom+xml><link href=/features.atom rel=alternate title="V8 JS/Wasm features Atom feed" type=application/atom+xml><script>document.documentElement.className+=' js'</script><meta content="The brand-new Web Tooling Benchmark helps identify and fix V8 performance bottlenecks in Babel, TypeScript, and other real-world projects." name=description><header id=header><h1><a href=/ >V8</a></h1><a href=#navigation-toggle id=nav-toggle>显示导肮</a><nav><ul><li><a href=/ >主页</a><li class=active><a href=/blog/ >博客</a><li><a href=/docs/ >文档</a><li><a href=/features title="JavaScript 和 WebAssembly 的新特性">JS/Wasm 新特性</a><li><a href=/grant>Research</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>Announcing the Web Tooling Benchmark</h1><p class=meta>发布时间 <time datetime="2017-11-06 13:33:37" itemprop=datePublished title="2017-11-06 13:33:37">2017-11-06</time> · 标签： <a href=/blog/tags/benchmarks/ class=tag>benchmarks</a> <a href=/blog/tags/node.js/ class=tag>Node.js</a></header><div itemprop=articleBody><p>JavaScript performance has always been important to the V8 team, and in this post we would like to discuss a new JavaScript <a href=https://v8.github.io/web-tooling-benchmark>Web Tooling Benchmark</a> that we have been using recently to identify and fix some performance bottlenecks in V8. You may already be aware of V8’s <a href=/blog/v8-nodejs>strong commitment to Node.js</a> and this benchmark extends that commitment by specifically running performance tests based on common developer tools built upon Node.js. The tools in the Web Tooling Benchmark are the same ones used by developers and designers today to build modern web sites and cloud-based applications. In continuation of our ongoing efforts to focus on <a href=/blog/real-world-performance/ >real-world performance</a> rather than artificial benchmarks, we created the benchmark using actual code that developers run every day.<p>The Web Tooling Benchmark suite was designed from the beginning to cover important <a href=https://github.com/nodejs/benchmarking/blob/master/docs/use_cases.md#web-developer-tooling>developer tooling use cases</a> for Node.js. Because the V8 team focuses on core JavaScript performance, we built the benchmark in a way that focuses on the JavaScript workloads and excludes measurement of Node.js-specific I/O or external interactions. This makes it possible to run the benchmark in Node.js, in all browsers, and in all major JavaScript engine shells, including <code>ch</code> (ChakraCore), <code>d8</code> (V8), <code>jsc</code> (JavaScriptCore) and <code>jsshell</code> (SpiderMonkey). Even though the benchmark is not limited to Node.js, we are excited that the <a href=https://github.com/nodejs/benchmarking>Node.js benchmarking working group</a> is considering using the tooling benchmark as a standard for Node performance as well (<a href=https://github.com/nodejs/benchmarking/issues/138>nodejs/benchmarking#138</a>).<p>The individual tests in the tooling benchmark cover a variety of tools that developers commonly use to build JavaScript-based applications, for example:<ul><li>The <a href=https://github.com/babel/babel>Babel</a> transpiler using the <code>es2015</code> preset.<li>The parser used by Babel — named <a href=https://github.com/babel/babylon>Babylon</a> — running on several popular inputs (including the <a href=https://lodash.com/ >lodash</a> and <a href=https://github.com/developit/preact>Preact</a> bundles).<li>The <a href=https://github.com/ternjs/acorn>acorn</a> parser used by <a href=http://webpack.js.org/ >webpack</a>.<li>The <a href=http://www.typescriptlang.org/ >TypeScript</a> compiler running on the <a href=https://github.com/tastejs/todomvc/tree/master/examples/typescript-angular>typescript-angular</a> example project from the <a href=https://github.com/tastejs/todomvc>TodoMVC</a> project.</ul><p>See the <a href=https://github.com/v8/web-tooling-benchmark/blob/master/docs/in-depth.md>in-depth analysis</a> for details on all the included tests.<p>Based on past experience with other benchmarks like <a href=http://browserbench.org/Speedometer>Speedometer</a>, where tests quickly become outdated as new versions of frameworks become available, we made sure it is straight-forward to update each of the tools in the benchmarks to more recent versions as they are released. By basing the benchmark suite on npm infrastructure, we can easily update it to ensure that it is always testing the state of the art in JavaScript development tools. Updating a test case is just a matter of bumping the version in the <code>package.json</code> manifest.<p>We created a <a href=http://crbug.com/v8/6936>tracking bug</a> and a <a href=https://docs.google.com/spreadsheets/d/14XseWDyiJyxY8_wXkQpc7QCKRgMrUbD65sMaNvAdwXw>spreadsheet</a> to contain all the relevant information that we have collected about V8’s performance on the new benchmark up to this point. Our investigations have already yielded some interesting results. For example, we discovered that V8 was often hitting the slow path for <code>instanceof</code> (<a href=http://crbug.com/v8/6971>v8:6971</a>), incurring a 3–4× slowdown. We also found and fixed performance bottlenecks in certain cases of property assignments of the form of <code>obj[name] = val</code> where <code>obj</code> was created via <code>Object.create(null)</code>. In these cases, V8 would fall off the fast-path despite being able to utilize the fact that <code>obj</code> has a <code>null</code> prototype (<a href=http://crbug.com/v8/6985>v8:6985</a>). These and other discoveries made with the help of this benchmark improve V8, not only in Node.js, but also in Chrome.<p>We not only looked into making V8 faster, but also fixed and upstreamed performance bugs in the benchmark’s tools and libraries whenever we found them. For example, we discovered a number of performance bugs in <a href=https://github.com/babel/babel>Babel</a> where code patterns like<pre class=language-js><code class=language-js>value <span class="token operator">=</span> items<span class="token punctuation">[</span>items<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><p>lead to accesses of the property <code>"-1"</code>, because the code didn’t check whether <code>items</code> is empty beforehand. This code pattern causes V8 to go through a slow-path due to the <code>"-1"</code> lookup, even though a slightly modified, equivalent version of the JavaScript is much faster. We helped to fix these issues in Babel (<a href=https://github.com/babel/babel/pull/6582>babel/babel#6582</a>, <a href=https://github.com/babel/babel/pull/6581>babel/babel#6581</a> and <a href=https://github.com/babel/babel/pull/6580>babel/babel#6580</a>). We also discovered and fixed a bug where Babel would access beyond the length of a string (<a href=https://github.com/babel/babel/pull/6589>babel/babel#6589</a>), which triggered another slow-path in V8. Additionally we <a href=https://twitter.com/bmeurer/status/926357262318305280>optimized out-of-bounds reads of arrays and strings</a> in V8. We’re looking forward to continue <a href=https://twitter.com/rauchg/status/924349334346276864>working with the community</a> on improving the performance of this important use case, not only when run on top of V8, but also when run on other JavaScript engines like ChakraCore.<p>Our strong focus on real-world performance and especially on improving popular Node.js workloads is shown by the constant improvements in V8’s score on the benchmark over the last couple of releases:<figure><img alt="" height=371 loading=lazy src=/_img/web-tooling-benchmark/chart.svg width=600></figure><p>Since V8 v5.8, which is the last V8 release before <a href=/blog/launching-ignition-and-turbofan>switching to the Ignition+TurboFan architecture</a>, V8’s score on the tooling benchmark has improved by around <strong>60%</strong>.<p>Over the last several years, the V8 team has come to recognize that no one JavaScript benchmark — even a well-intentioned, carefully crafted one — should be used as a single proxy for a JavaScript engine’s overall performance. However, we do believe that the new <strong>Web Tooling Benchmark</strong> highlights areas of JavaScript performance that are worth focusing on. Despite the name and the initial motivation, we have found that the Web Tooling Benchmark suite is not only representative of tooling workloads, but is representative of a large range of more sophisticated JavaScript applications that are not tested well by front end-focused benchmarks like Speedometer. It is by no means a replacement for Speedometer, but rather a complementary set of tests.<p>The best news of all is that given how the Web Tooling Benchmark is constructed around real workloads, we expect that our recent improvements in benchmark scores will translate directly into improved developer productivity through <a href=https://xkcd.com/303/ >less time waiting for things to build</a>. Many of these improvements are already available in Node.js: at the time of writing, Node 8 LTS is at V8 v6.1 and Node 9 is at V8 v6.2.<p>The latest version of the benchmark is hosted at <a href=https://v8.github.io/web-tooling-benchmark/ >https://v8.github.io/web-tooling-benchmark/</a>.</div><footer><div><picture><source srcset="/_img/avatars/benedikt-meurer.avif, /_img/avatars/benedikt-meurer@2x.avif 2x" type=image/avif><img alt="" height=96 loading=lazy src=/_img/avatars/benedikt-meurer.jpg width=96 srcset="/_img/avatars/benedikt-meurer@2x.jpg 2x"></picture><p>作者：Benedikt Meurer (<a href=https://twitter.com/bmeurer>@bmeurer</a>), JavaScript Performance Juggler.</div><a href=https://twitter.com/v8js/status/927572065598824448 class=retweet>Retweet this article!</a></footer></article></main><footer id=footer><div><nav><a href=https://v8.dev/blog/web-tooling-benchmark>原文</a> · <a href=/logo/ >商标</a> · <a href=/terms/ >条款</a> · <a href=https://policies.google.com/privacy/ >隐私</a> · <a href=https://twitter.com/v8js rel="me nofollow">Twitter</a> · <a href=https://github.com/justjavac/v8.js.cn/tree/master/./src/blog/web-tooling-benchmark.md rel=nofollow>在 GitHub 编辑此页面</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>如无特殊说明，此 V8 项目中使用到的所有示例代码均基于 <a href=https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE>V8's BSD-style license</a> 发布。页面中的文字内容采用 <a href=https://creativecommons.org/licenses/by/3.0/ >the Creative Commons Attribution 3.0 License</a> 进行许可。更详细的信息可以在 <a href=/terms#site-policies>站点策略</a> 中找到。</small></footer><script src=/_js/dark-mode-toggle.mjs type=module></script><script src=/_js/main.mjs type=module></script><script src=/_js/legacy.js nomodule></script>